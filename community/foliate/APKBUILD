# Contributor: prspkt <prspkt@protonmail.com>
# Maintainer: prspkt <prspkt@protonmail.com>
pkgname=foliate
pkgver=3.0.0
pkgrel=0
_foliatejs=f75fbba096e8fc1c775ea1c162fe1d3322cd5121
pkgdesc="Simple and modern eBook viewer"
url="https://johnfactotum.github.io/foliate/"
arch="noarch !armhf !s390x !riscv64" # missing gjs
license="GPL-3.0-or-later"
depends="
	desktop-file-utils
	gjs
	libadwaita
	webkit2gtk-6.0
	"
makedepends="
	gettext-dev
	gjs-dev
	glib-dev
	gtk4.0-dev
	libadwaita-dev
	meson
	webkit2gtk-6.0-dev
	"
subpackages="$pkgname-lang"
options="!check"
source="https://github.com/johnfactotum/foliate/archive/$pkgver/foliate-$pkgver.tar.gz
	https://github.com/johnfactotum/foliate-js/archive/$_foliatejs/foliate-js-$_foliatejs.tar.gz
	"

prepare() {
	default_prepare

	rmdir -v src/foliate-js
	ln -sv "$srcdir"/foliate-js-$_foliatejs src/foliate-js
}

build() {
	abuild-meson . output
	meson compile -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
}

sha512sums="
ecd448f434da8d12aaf7cb8f50caa91ff5b7881d2d7b7614664ba653e8520631e6773024ba599086c2d963febba62542740d9b49fb6e44caeac82d8eb1a85155  foliate-3.0.0.tar.gz
b5628b6eef2c935b06224528477febc16603db75411f3ece90b83d39ab8a7108e11115258b1ced16810eceecaad768a1049b5baa6f874c302e0f6cf72c1f6a28  foliate-js-f75fbba096e8fc1c775ea1c162fe1d3322cd5121.tar.gz
"
