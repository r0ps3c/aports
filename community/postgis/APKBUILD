# Contributor: Bjoern Schilberg <bjoern@intevation.de>
# Contributor: Holger Jaekel <holger.jaekel@gmx.de>
maintainer="Holger Jaekel <holger.jaekel@gmx.de>"
pkgname=postgis
pkgver=3.5.1
pkgrel=0
pkgdesc="spatial database extender for PostgreSQL object-relational database"
url="https://postgis.net/"
arch="all"
license="GPL-2.0-or-later"
depends="perl"
makedepends="
	gdal-dev
	geos-dev
	json-c-dev
	libxml2-dev
	pcre2-dev
	perl-dev
	postgresql-dev
	proj-dev
	protobuf-c-dev
	sfcgal-dev
	"
subpackages="$pkgname-doc"
source="https://download.osgeo.org/postgis/source/postgis-$pkgver.tar.gz"
options="!check" # tests depends on a running PostgreSQL server

prepare() {
	default_prepare
	update_config_sub
}

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr
	make
}

package() {
	depends="$depends postgresql$(pg_config --major-version)"

	make DESTDIR="$pkgdir" install
}

sha512sums="
72d60b9cbb9652555f70e86b18d32a578799f4dff8749bfc91f91c2d32142b7c85bf2d50a1ea5effbc25f84b1cbdcaf4586400af89b5ab37e5c03a87e0d20a6c  postgis-3.5.1.tar.gz
"
