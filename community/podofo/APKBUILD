# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=podofo
pkgver=0.10.0
pkgrel=0
pkgdesc="A C++ library to work with the PDF file format"
url="https://podofo.sourceforge.net/"
arch="all"
license="GPL-2.0-only"
makedepends="tiff-dev libpng-dev fontconfig-dev
	cmake lua-dev openssl-dev>3 libidn-dev libxml2-dev"
subpackages="$pkgname-dev"
source="$pkgname-$pkgver.tar.gz::https://github.com/podofo/podofo/archive/refs/tags/$pkgver.tar.gz"

# secfixes:
#   0.9.7-r0:
#     - CVE-2019-9199
#     - CVE-2019-9687
#     - CVE-2018-19532
#     - CVE-2018-20751
#     - CVE-2018-20797
#     - CVE-2019-10723
#     - CVE-2019-20093
#   0.9.6-r0:
#     - CVE-2017-6848
#     - CVE-2017-7378
#     - CVE-2017-7379
#     - CVE-2017-7380
#     - CVE-2017-7381
#     - CVE-2017-7382
#     - CVE-2017-7383
#     - CVE-2017-7994
#     - CVE-2017-8053
#     - CVE-2017-8054
#     - CVE-2017-8378
#     - CVE-2017-8787
#     - CVE-2018-5295
#     - CVE-2018-5296
#     - CVE-2018-5308
#     - CVE-2018-5309
#     - CVE-2018-5783
#     - CVE-2018-6352
#     - CVE-2018-8000
#     - CVE-2018-8001
#     - CVE-2018-8002
#     - CVE-2018-11254
#     - CVE-2018-11255
#     - CVE-2018-11256
#     - CVE-2018-12982
#     - CVE-2018-12983
#   0.9.5-r0:
#     - CVE-2017-6843
#     - CVE-2017-6844
#     - CVE-2017-6845
#     - CVE-2017-6846
#     - CVE-2017-6847
#     - CVE-2017-6849

build() {
	cmake -B build . \
		-DCMAKE_BUILD_TYPE=None \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DPODOFO_BUILD_STATIC=0 \
		-DPODOFO_HAVE_JPEG_LIB=1 \
		-DPODOFO_HAVE_PNG_LIB=1 \
		-DPODOFO_HAVE_TIFF_LIB=1
	make -C build
}

package() {
	make -C build DESTDIR="$pkgdir" install
}

sha512sums="
674024af031392253bc9ea02e392fa7b4a5c8894f3129e05f27133774ccf8b696e225789e886dedbe90bc2323c318b76e79857453a56d6014d7a5514e3f861a2  podofo-0.10.0.tar.gz
"
