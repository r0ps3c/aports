# Contributor: Leo <thinkabit.ukim@gmail.com>
# Maintainer: Jakub Jirutka <jakub@jirutka.cz>
pkgname=nerd-fonts
pkgver=3.0.1
pkgrel=0
provides="nerd-fonts-stable=$pkgver-r$pkgrel"
replaces="nerd-fonts-stable"
pkgdesc="Patched developer targeted fonts with a high number of glyphs"
url="https://nerdfonts.com"
arch="noarch"
license="MIT AND OFL-1.1 AND Apache-2.0"
options="!check"  # no testsuite provided
builddir="$srcdir"

# If <fontname> is empty, <zipname> will be used instead.
# <origname> is used only for pkgdesc and it may be empty.
# "~" will be replaced with " "
# <id>,<zipname>,<fontname>,<origname>
_fonts="
	anonymous-pro,AnonymousPro,Anonymice,Anonymous~Pro
	arimo,Arimo,,
	bitstrom-wera-sans-mono,BitstreamVeraSansMono,BitstromWeraNerdFontMono,Bitstrom~Wera~Sans~Mono
	cascadia-code,CascadiaCode,CaskaydiaCove,Cascadia~Code
	comic-shanns-mono,ComicShannsMono,ComicShannsMono,Comic~Shanns~Mono
	dejavu-sans-mono,DejaVuSansMono,DejaVuSansM,DejaVu~Sans~Mono
	droid-sans-mono,DroidSansMono,DroidSansM,Droid~Sans~Mono
	fira-code,FiraCode,FiraCode,Fira~Code
	fira-mono,FiraMono,FiraMono,Fira~Mono
	go-mono,Go-Mono,GoMono,Go~Mono
	hack,Hack,,
	hasklig,Hasklig,Hasklug,Hasklig
	hermit,Hermit,Hurmit,Hermit
	ia-writer,iA-Writer,iMWriting,iA~Writer
	ibm-plex-mono,IBMPlexMono,BlexMono,IBM~Plex~Mono
	inconsolata,Inconsolata,,
	jetbrains-mono,JetBrainsMono,JetBrainsMono,JetBrains~Mono
	liberation-mono,LiberationMono,LiterationMono,Liberation~Mono
	meslo,Meslo,,
	monofur,Monofur,Monofur,
	mononoki,Mononoki,Mononoki,
	overpass,Overpass,,
	share-tech-mono,ShareTechMono,ShureTechMono,Share~Tech~Mono
	source-code-pro,SourceCodePro,SauceCodePro,Source~Code~Pro
	space-mono,SpaceMono,SpaceMono,Space~Mono
	terminus,Terminus,Terminess,Terminus
	tinos,Tinos,,
	ubuntu,Ubuntu,,
	ubuntu-mono,UbuntuMono,UbuntuMono,Ubuntu~Mono
	victor-mono,VictorMono,VictorMono,Victor~Mono
	"
_depends_all=""
subpackages="nerd-fonts-all:_all"
source=""
for _font in $_fonts; do
	_pkgname="font-${_font%%,*}-nerd"
	_filename=${_font#*,}; _filename=${_filename%%,*}

	_depends_all="$_depends_all $_pkgname"
	subpackages="$subpackages $_pkgname:_subpackage:noarch"
	source="$source $_pkgname-$pkgver.tar.xz::https://github.com/ryanoasis/nerd-fonts/releases/download/v$pkgver/$_filename.tar.xz"
done

package() {
	mkdir -p "$pkgdir"
}

_subpackage() {
	local id=${subpkgname#font-}; id=${id%-nerd}

	local IFS_OLD=$IFS IFS=','
	set -- $(printf '%s\n' "$_fonts" | grep "^\s*$id," | tr '~' ' ')
	if [ $# -lt 2 ]; then
		error "$id was not found in \$_fonts or wrong entry!"
		return 1
	fi
	IFS=$IFS_OLD

	local fontname=${3:-$2}
	local origname=${4-}
	depends="fontconfig"
	pkgdesc="$fontname Nerd Font${origname:+" (modified $origname Font)"}"

	# for backward compatibility (Alpine <3.16)
	case "$subpkgname" in
		font-ibm-plex-mono-nerd) provides="font-ibm-plex-nerd=$pkgver-r$pkgrel";;
		font-libertion-mono-nerd) provides="font-liberation-nerd=$pkgver-r$pkgrel";;
		font-ubuntu-nerd) depends="$depends font-ubuntu-mono-nerd";;
	esac

	cd "$builddir"
	install -Dm644 ./"$fontname"*.*tf -t "$subpkgdir"/usr/share/fonts/${subpkgname#font-}/
}

_all() {
	pkgdesc="Meta package for all patched Nerd Fonts"
	depends="$_depends_all"

	mkdir -p "$subpkgdir"
}

sha512sums="
f36cc9c2743fdb4ac84df9ec8f5c80acfe7a8c0e749ab1af71f906e7b2d51ef0d7932f6b4809e6bf3f0c09b6ebe6a39b7d634ec67fadf06fe1ab42ded4b990b9  font-anonymous-pro-nerd-3.0.1.tar.xz
e35c21d30f7bbc790a8377b46205fcf52e36655cc9454627549441d69525e5e133ec711c503ea25c495cadf2972e0e6bb282b814eb15e01350886a0ffcfd6a36  font-arimo-nerd-3.0.1.tar.xz
48c75bfe9e52f88ccff915d746377f4b03b3d389de89a931e01eadfd505a1c0c352f907198f22cbb30e7264cb7efafd3ab7a13eafaf9601c178a04918ecc273c  font-bitstrom-wera-sans-mono-nerd-3.0.1.tar.xz
06da9b5c1b257d3a15b15469fae7d04d7261cb94d175ce17328a9e5659a744d1199331d5f0b60ad03435268ba8ad908fc76d85caeb16d9e07ece13876f736498  font-cascadia-code-nerd-3.0.1.tar.xz
1a56c639eef742513b4573264f2c156643fc10481859552fd0eba782eeafd452ae24dd6d21f0a5dc57ceec60c28839b8ab2854a5a534b69559ddd7b466590090  font-comic-shanns-mono-nerd-3.0.1.tar.xz
13849c0adc787848aa8094b3ad3bc4866eb20033c0becc768aba27790e0b098cf5e5690ac11ddf48d5969282df7c304d17c1fc94962f4a7bbabd915a27dbebeb  font-dejavu-sans-mono-nerd-3.0.1.tar.xz
c4410e4853655fdfc1ad00bca631a87cdd2d5e23ef103ca4a938ce8f6c28b9ed62d5d5ebd0d66ddd7a6d0e5139e2efd1761045cfe1248a87fa7b4ab0cf1a4e6e  font-droid-sans-mono-nerd-3.0.1.tar.xz
a5d4202b8fdadc295bdc08a0bf226c187102492aef94e17f9327b1683c1370ab535c8d6fa725f89935b79a26352da765b2066468326ff846f21dbe0929fcc016  font-fira-code-nerd-3.0.1.tar.xz
b178c64a0c5a5b7ced865064fcd08e5473a230dd7d1ef76d4a5e54aa473138e22c16fb2af5e28bdbdc5bcebda3d9b2f549b912cfa952ba8607e4deab098172a8  font-fira-mono-nerd-3.0.1.tar.xz
16b8190f9d9e39acdd731e1eeaf7f744b3b5db8a9917c333ceacc2053b3a767242f0039f6ca1a7653cee3ed48264c8350d33addf1f04f205b9c5926b42e74d5b  font-go-mono-nerd-3.0.1.tar.xz
5189ea6d3f984ec6257db0d9bfcac7997b3e7cf384e29b5a8fa2e09b5a3a66c5a20e516000a50ca43376213dc762224970dfd827caadd3ec2aaef44f09e537c6  font-hack-nerd-3.0.1.tar.xz
99eebe08ff918d331960b36a81e435abc3ca19ef61850172f37b9c590f2ba5cd818421df3b5f35f55d91cac9188322eee205f11a7a1e340b0f07f326844dd793  font-hasklig-nerd-3.0.1.tar.xz
3a0e800989057105e2a1cdee3b504b5002fb7ebe163e01d7b98b23399e430130464fb5ca264b148de20cc4299a3f90c4cf3aadb307d491eb04d29024605c2d58  font-hermit-nerd-3.0.1.tar.xz
c082ea0d62254e21054a667924c0f4f409238177c2f3a7f4dad879469e1a6e91aa21409083e9124e3e68bbd15313bab704f631f3373688de1dd829b7b1299eff  font-ia-writer-nerd-3.0.1.tar.xz
436eff2a50745cfef702df9d52d6825a695a55bb57de7f4b873fce37419f8b440a6cb0e1f58d4b52ed5ab4d3d8227349b3e0bd202115c1c471565f52d6bf1fe9  font-ibm-plex-mono-nerd-3.0.1.tar.xz
ebf291b116ec9a5ff2cc348915d5a68105df31b9fd8191cc01ea938bb06a06e449fcb3fb13a724835bd5fea3af7ad07b639d3f80fc94744016f1cf332109d0f2  font-inconsolata-nerd-3.0.1.tar.xz
8fa6337603684d5da8f219e3db377d28ebda576614481477471c5f81f9ce3f1e163fa354e14ecdb3649feacb0e7c00ecf52268987eb16f3ecaa55999e194f0f2  font-jetbrains-mono-nerd-3.0.1.tar.xz
2527927982adfb2937a7890be02676f4ac100fcbf8e5ccdfc213a3cf9fe04c199bee7af9f94706fdbf1b8f8cbbb351da199fc4cb4fd852017da1ed169d27d399  font-liberation-mono-nerd-3.0.1.tar.xz
4f956904b66f33db7acc0b52cd62947d89737a6dc226f0627e4b6f74c5024563d5a6be9c8c47e3e5f77838fef5ae8e8f1a3ecef37d2039f1efb4b525cdd5531a  font-meslo-nerd-3.0.1.tar.xz
c2fcb5269ac32066b94e0b3b708f5a7f35b526bfe8effb7c34a0647a1b599b6638443e41b84e6c7f90d1509da54e091ddb584e6036ef92bb6739b058396fbed6  font-monofur-nerd-3.0.1.tar.xz
752a45a4dba018e94cd6ff9db888f24869b9c127223fc0c7c676c95463bace5886f82619154181675af90398d808e4da7edf2d5014fee58b58acf912dcc33f55  font-mononoki-nerd-3.0.1.tar.xz
a0ae72b33f112473aa2a61a328a9e7a51ac6e681ba964f5d3525214072e51760e01a93ce3672dbb49bee490a6cc2eadc1ab90bfa2691d81ea3bfb6ad43cbef4f  font-overpass-nerd-3.0.1.tar.xz
aaac9782b7c05fa93e107b4f88c7e10b077a695685dcbc0137b94713a867f05aec64aedafeaf4b7c83ababfec3630a600f2f0f8ebc54c36a37c6902ac58551de  font-share-tech-mono-nerd-3.0.1.tar.xz
6995f58d5a5a3d9b6162faa7b9021baf1c596d719abeafb5e6209e3b36b982cc014f549a4c05e4072ab210e58933707733e9a7d175b034a80179ec0897f4bb3a  font-source-code-pro-nerd-3.0.1.tar.xz
aa49744bbd836c53317733e84177478ec4e94387c333a69c59e16e8c0a600af24f4bb675fd8df394b6bfb0252afcd3f83dfc05dbf3ca0602f77f8a312029e03f  font-space-mono-nerd-3.0.1.tar.xz
3d1aff5f3fa9241a0525f858bc8b040b566e03bc5c41177856cd9439d6551c118f5aff16a6556736d1296c0bbf3b93087184a04f91c563174f307df4eed1d5a0  font-terminus-nerd-3.0.1.tar.xz
4f977cc52eb137356aa58008ee2bf15f27715a526ecfa36049bb8d1e27e2b3a322ed5d53493ec0e9c2e4e5278b2f783a7cc587087d748c44433134a44d7a2fb1  font-tinos-nerd-3.0.1.tar.xz
32b5e98b72432e2c1cfd7306004e0cf95b4bd53dda4e3335d593ca4b03e22686eac6d77871deefc05700cc57a4e5d862181db33b47192c1934de39ae52929b0f  font-ubuntu-nerd-3.0.1.tar.xz
d2e6a516eb065a2ae1fdbcd165a8ba235dbe1264a108fd76036c556f3677dfe985caa2bff6ab98881faaac347334b02753fee6114d0f31c2ac620232a2f50a7a  font-ubuntu-mono-nerd-3.0.1.tar.xz
4fb25a0b8349eac5b30293078935a92e74b5efec06f87cc3e121f5e4312398e7fef1a148c01c7efbc4879d5d6a007716b4f8593cc54c9812aa47a32b51ab9f6f  font-victor-mono-nerd-3.0.1.tar.xz
"
