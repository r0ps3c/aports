From 9e2ada31c5aa5c6ffcd7329fb2b7571e6e67f854 Mon Sep 17 00:00:00 2001
From: knuxify <knuxify@gmail.com>
Date: Tue, 17 Jan 2023 14:56:25 +0100
Subject: [PATCH] Fix potential crash when applying keyboard shortcuts

https://gitlab.gnome.org/raggesilver/blackbox/-/merge_requests/74
---
 src/services/Shortcuts.vala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/services/Shortcuts.vala b/src/services/Shortcuts.vala
index e87f98a..8551624 100644
--- a/src/services/Shortcuts.vala
+++ b/src/services/Shortcuts.vala
@@ -171,8 +171,10 @@ public class Terminal.Keymap : Object, Json.Serializable {
   }
 
   public void apply (Gtk.Application app) {
-    foreach (string key in this.keymap.get_keys ()) {
-      string[] accelerators = this.keymap.@get (key).to_array ();
+    var iter = this.keymap.map_iterator ();
+    while (iter.next ()) {
+      string key = iter.get_key ();
+      string[] accelerators = { iter.get_value () };
       string[] filtered_accelerators = {};
 
       foreach (string? accel in accelerators) {
-- 
2.39.0

