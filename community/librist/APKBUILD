# Contributor: Kevin Wang <kevin@muxable.com>
# Maintainer: Kevin Wang <kevin@muxable.com>
pkgname=librist
pkgver=0.2.9
pkgrel=0
pkgdesc="Reliable Internet Stream Transport (RIST)"
url="https://www.rist.tv/"
arch="all"
license="BSD-2-Clause"
makedepends="meson linux-headers cjson-dev mbedtls-dev"
checkdepends="cmocka-dev"
subpackages="$pkgname-progs $pkgname-dev"
source="$pkgname-$pkgver.tar.gz::https://code.videolan.org/rist/librist/-/archive/v$pkgver/librist-v$pkgver.tar.gz
	fix-test.patch
	"
builddir="$srcdir/librist-v$pkgver"

build() {
	abuild-meson build
	meson compile -C build
}

check() {
	meson test --no-rebuild --print-errorlogs -C build
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C build
}

progs() {
	pkgdesc="Tools for working with RIST"
	depends=""
	amove usr/bin
}

sha512sums="
ee151b10b31c9f296bed4ed17902fc8f9a23247023a07642b8bcc45bec90c70ba7ac28927d6a5dede0a50d97db4922dfc2dd4a6b9c75090ed4c8005a99941686  librist-0.2.9.tar.gz
8a1cbb5aa0233ff059ccef9d914673fb95ba6ff2184deddc509b24e0ae1c3f29941074bc2e96b174a5ab748f9f25b54debbdde59c136e0c3020d462a53410ce2  fix-test.patch
"
