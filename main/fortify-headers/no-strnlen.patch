--- a/include/string.h
+++ b/include/string.h
@@ -296,7 +296,9 @@ _FORTIFY_FN(strncat) char *strncat(char
 	__fh_size_t __b = __fh_bos(__d, 0);
 
 	if (__n > __b) {
-		__fh_size_t __sl = strnlen(__s, __n);
+		__fh_size_t __sl = strlen(__s);
+		if (__sl > __n)
+			__sl = __n;
 		__fh_size_t __dl = strlen(__d);
 		if (__sl + __dl + 1 > __b)
 			__builtin_trap();
@@ -316,7 +318,9 @@ _FORTIFY_FN(strncpy) char *strncpy(char
 #if __has_builtin(__builtin___strncpy_chk) && FORTIFY_USE_NATIVE_CHK
 	return __builtin___strncpy_chk(__d, __s, __n, __fh_bos(__d, 0));
 #else
-	__fh_size_t max_len_s = strnlen(__s, __n);
+	__fh_size_t max_len_s = strlen(__s);
+	if (max_len_s > __n)
+		max_len_s = __n;
 	if (__fh_overlap(__d, max_len_s, __s, max_len_s))
 		__builtin_trap();
 
