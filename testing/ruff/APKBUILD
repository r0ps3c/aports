# Maintainer: Hugo Osvaldo Barrera <hugo@whynothugo.nl>
pkgname=ruff
pkgver=0.0.236
pkgrel=0
pkgdesc="Extremely fast Python linter"
url="https://github.com/charliermarsh/ruff"
# ppc64le, s390x, riscv64: ring
# x86, armhf, armv7: fails tests on 32-bit
arch="all !x86 !armhf !armv7 !ppc64le !s390x !riscv64"
license="MIT"
makedepends="maturin cargo py3-installer"
source="$pkgname-$pkgver.tar.gz::https://github.com/charliermarsh/ruff/archive/refs/tags/v$pkgver.tar.gz"

export CARGO_PROFILE_RELEASE_OPT_LEVEL=2

prepare() {
	default_prepare

	cargo fetch --locked
}

build() {
	maturin build --release --frozen --manylinux off
}

check() {
	cargo test --frozen
}

package() {
	python3 -m installer -d "$pkgdir" \
		target/wheels/*.whl
}

sha512sums="
340242d90798f31debd558b36ebec8ba3b42e48965bdf8b1ebfb27ecfa66dae0be6195b17ed1e2da0c0e3eff83f4d680179ae7c261dd24dc9e76e3f9a24c5bfc  ruff-0.0.236.tar.gz
"
