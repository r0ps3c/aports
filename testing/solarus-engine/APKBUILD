# Contributor: Díaz Urbaneja Diego <sodomon2@gmail.com>
# Maintainer: Díaz Urbaneja Diego <sodomon2@gmail.com>
pkgname=solarus-engine
_realname=solarus
pkgver=1.6.5
pkgrel=0
pkgdesc="Solarus is an open-source adventure 2D game engine written in C++"
url="https://solarus-games.org/"
arch="all !ppc64le" # no luajit found
license="GPL-3.0-Only"
depends="
	libvorbis
	libogg
	libmodplug
	luajit
	mesa
	openal-soft
	physfs
	qt5-qtbase
	qt5-qttools
	sdl2
	sdl2_image
	sdl2_ttf
	"
makedepends="
	cmake
	glm-dev
	libvorbis-dev
	libogg-dev
	libmodplug-dev
	luajit-dev
	mesa-dev
	openal-soft-dev
	physfs-dev
	qt5-qtbase-dev
	qt5-qttools-dev
	sdl2-dev
	sdl2_image-dev
	sdl2_ttf-dev
	"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://gitlab.com/solarus-games/solarus/-/archive/v$pkgver/solarus-v$pkgver.tar.gz"
builddir="$srcdir/$_realname-v$pkgver"

build() {
	cmake -B build \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_BUILD_TYPE=Release \
		-DSOLARUS_GUI=ON
	make -C build/
}

check() {
	ctest -L
}

package() {
	make -C build DESTDIR="$pkgdir" install
}

sha512sums="
3fc7473f1b7dd80cbcb0a7a639701f8b12bd40ee918a7853805bd54f877e752b4c31c26828e62248ca4594b3aed41a8c61a16be3b14b293f08d9ba938a723e91  solarus-engine-1.6.5.tar.gz
"
