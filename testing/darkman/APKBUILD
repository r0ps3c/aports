# Maintainer: Hugo Osvaldo Barrera <hugo@whynothugo.nl>
pkgname=darkman
pkgver=1.5.2
pkgrel=0
pkgdesc="Daemon for dark-mode and light-mode transitions on Unix-like desktop"
url="https://darkman.whynothugo.nl/"
arch="all"
license="ISC"
makedepends="go scdoc"
subpackages="
	$pkgname-doc
	"
source="https://gitlab.com/WhyNotHugo/darkman/-/archive/v$pkgver/darkman-v$pkgver.tar.gz"
builddir="$srcdir/$pkgname-v$pkgver"
options="!check"

export GOCACHE="${GOCACHE:-"$srcdir/go-cache"}"
export GOTMPDIR="${GOTMPDIR:-"$srcdir"}"
export GOMODCACHE="${GOMODCACHE:-"$srcdir/go"}"
# This works around two issues:
# 1. tarballs lack version metadata required here.
# 2. the default Alpine LDFLAGS don't work with go.
export LDFLAGS="-X main.Version=$pkgver"

build() {
	make build
}

package() {
	make DESTDIR="$pkgdir/" PREFIX=/usr/ install
}

sha512sums="
33c70d5ebe9797b296727d228228b125d939e1e76d9011c24cf46951a93f48d12aea95b6e305eeee2ec880370bb673995416dc4fbf921088d28f3a8f484564d0  darkman-v1.5.2.tar.gz
"
