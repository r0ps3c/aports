From 0718dfb68eaae5d9547690458c6f33b3243d9d44 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Gina=20H=C3=A4u=C3=9Fge?= <gina@octoprint.org>
Date: Wed, 4 Oct 2023 13:35:56 +0200
Subject: [PATCH] =?UTF-8?q?=F0=9F=92=9A=20Fix=203.12=20unit=20tests?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 src/octoprint/plugin/core.py  | 5 ++++-
 tests/plugin/test_settings.py | 2 ++
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/octoprint/plugin/core.py b/src/octoprint/plugin/core.py
index 297386e4a9..b793f401d0 100644
--- a/src/octoprint/plugin/core.py
+++ b/src/octoprint/plugin/core.py
@@ -115,7 +115,10 @@ def extract_names(node):
             for a in reversed(assignments):
                 targets = extract_target_ids(a)
                 if key in targets:
-                    if isinstance(a.value, ast.Str):
+                    if isinstance(a.value, ast.Constant):
+                        result[key] = a.value.value
+
+                    elif isinstance(a.value, ast.Str):
                         result[key] = a.value.s
 
                     elif (
diff --git a/tests/plugin/test_settings.py b/tests/plugin/test_settings.py
index 6d5a3d4281..36f52182d1 100644
--- a/tests/plugin/test_settings.py
+++ b/tests/plugin/test_settings.py
@@ -111,6 +111,7 @@ def test_deprecated_forwarded_getter(
     called_method.__name__ = forwarded
     called_method.__qualname__ = forwarded
     called_method.__annotations__ = {}
+    called_method.__type_params__ = ()
 
     method = getattr(plugin_settings, deprecated)
     assert callable(method)
@@ -330,6 +331,7 @@ def test_deprecated_forwarded_setter(
     called_method.__name__ = forwarded
     called_method.__qualname__ = forwarded
     called_method.__annotations__ = {}
+    called_method.__type_params__ = ()
 
     method = getattr(plugin_settings, deprecated)
     assert callable(method)
