# Contributor: Martijn Braam <martijn@brixit.nl>
pkgname=logbookd
pkgver=0.1.3
pkgrel=0
pkgdesc="sqlite backed syslogd implementation"
url="https://git.sr.ht/~martijnbraam/logbookd"
arch="all"
license="MIT"
subpackages="$pkgname-doc $pkgname-openrc"
source="
	$pkgname-$pkgver.tar.gz::https://git.sr.ht/~martijnbraam/logbookd/archive/$pkgver.tar.gz
	logbookd.initd
	logbookd.confd
	"
makedepends="cmake meson sqlite-dev util-linux-dev scdoc"

build() {
	abuild-meson . output
	meson compile -C output
}

check() {
	meson test --no-rebuild -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output

	install -m755 -D "$srcdir"/logbookd.initd \
		"$pkgdir"/etc/init.d/logbookd
	install -m644 -D "$srcdir"/logbookd.confd \
		"$pkgdir"/etc/conf.d/logbookd
}


sha512sums="
47dd12a4f5474054a710de1454e476238debe22d6b85910c12b22dd2b07f7d4928e53cd2e61ed4e59ca56b05cf0e81c10aae994260d2a87da10ae6b4686049a1  logbookd-0.1.3.tar.gz
6590cb54a2c5613629f729f78b3b8e427808028d9b42462391eb74fa4d19fd5239d06eb3fc026d174f615e46b405d9ae74590ecf622459fc40664620372d5adf  logbookd.initd
5e8513643de4ba9e16dc7e7b541aa26e6b4e840b0fd07d3b72c6b0f687297cb80672068b8dec3e488637b16e53f77502f481d36351b40236d17ee32b6313ebab  logbookd.confd
"
