# Contributor: fossdd <fossdd@pwned.life>
maintainer="team/phosh <fossdd@pwned.life>"
pkgname=xdg-desktop-portal-phosh
pkgver=0_git20240621
_commit=2ffe0ef21b7e3333bec9a4256bb05c7fc6b10521
pkgrel=0
pkgdesc="xdg-desktop-portal implementation using GTK/GNOME/Phosh"
url="https://gitlab.gnome.org/guidog/xdg-desktop-portal-phosh"
arch="all"
license="GPL-3.0-or-later"
depends="
	gsettings-desktop-schemas
	xdg-desktop-portal
	"
makedepends="
	gnome-desktop-dev
	libadwaita-dev
	meson
	xdg-desktop-portal-dev
	"
source="https://gitlab.gnome.org/guidog/xdg-desktop-portal-phosh/-/archive/$_commit/xdg-desktop-portal-phosh-$_commit.tar.gz
	systemd-option.patch
	"
builddir="$srcdir/$pkgname-$_commit"
options="!check" # no tests

build() {
	abuild-meson \
		. output
	meson compile -C output
}

check() {
	meson test --no-rebuild --print-errorlogs -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
}

sha512sums="
1abf8c4e826a8f53b865e5d205d5690a4ea61732403ffab8427bea5cba2d7524e8fe9110ce20d0014a75033ecb32d8cdb22bd15da26a035afb6afb44ff565892  xdg-desktop-portal-phosh-2ffe0ef21b7e3333bec9a4256bb05c7fc6b10521.tar.gz
6606ae12df3e8d82a616802ee8b547cffc43012f344550c07cb65e5317015bb8779eca210c1d111da60300b4ac55f2d026a19a89a871315d0e6ea1b286b4f102  systemd-option.patch
"
