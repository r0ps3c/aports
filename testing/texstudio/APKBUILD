# Contributor: Jonas <3426-spameier@users.gitlab.alpinelinux.org>
# Maintainer: Jonas <3426-spameier@users.gitlab.alpinelinux.org>
pkgname=texstudio
pkgver=4.5.1
pkgrel=1
pkgdesc="fully featured LaTeX editor"
url="https://www.texstudio.org"
# disabled elsewhere due to huge size, request if you need it
arch="aarch64 x86_64"
license="GPL-3.0-or-later"
makedepends="
	cmake
	poppler-qt5-dev
	qt6-qt5compat-dev
	qt6-qtbase-dev
	qt6-qtdeclarative-dev
	qt6-qtsvg-dev
	qt6-qttools-dev
	qtermwidget-dev
	quazip-dev
	samurai
	"
source="$pkgname-$pkgver.tar.gz::https://github.com/texstudio-org/texstudio/archive/$pkgver.tar.gz
	qt6.patch
	$pkgname-qt6.5.patch::https://github.com/texstudio-org/texstudio/commit/c7fbb50f45ce845f6e67a651e32e01533825dab4.patch
	"
options="!check" # tests fail to build

build() {
	cmake -B build -G Ninja -Wno-dev \
		-DCMAKE_BUILD_TYPE=MinSizeRel \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DQT_VERSION_MAJOR=6 \
		-DNO_APPDATA=OFF
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
62f724d2b3fceb81423ba86240275188d2b00961564b67c4dfcc20d6dbb6d5ae2e6ab71b42e4e3353023ba0fcf1c0803e62c8bb5374d84a8ff9fa31ec7a06f22  texstudio-4.5.1.tar.gz
60380c7e962ea9deb9117c95153dc7f827b0534adeeb59b6de123d57264b74dba3c960744433686c68fac34f11d788125ba7bc08d36882b10f1282bfa597829d  qt6.patch
fa49e5857f484957a1efd0eebbdb2b9c2640ca1df3b1b3ffdf56710961c49cd9585b2ec39ea7d1be5339382b010e62d7bd1cb782252f7ba5082f22c480388dd2  texstudio-qt6.5.patch
"
