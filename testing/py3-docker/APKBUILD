# Maintainer: Antoine Martin (ayakael) <dev@ayakael.net>
# Contributor: Antoine Martin (ayakael) <dev@ayakael.net>

_pyname=docker
pkgname="py3-$_pyname"
pkgver=6.1.3
pkgrel=0
arch="noarch"
pkgdesc="A Python library for the Docker Engine API."
url="https://pypi.python.org/project/$_pyname"
license="Apache-2.0"
depends="
	py3-packaging
	py3-requests
	py3-urllib3
	py3-websocket-client
	py3-paramiko
	"
makedepends="
	py3-build
	py3-installer
	py3-setuptools
	py3-setuptools_scm
	py3-wheel
	"
checkdepends="
	py3-pytest
	py3-flake8
	py3-coverage
	py3-pytest-cov
	py3-pytest-timeout
	"
source="$pkgname-$pkgver.tar.gz::https://pypi.io/packages/source/${_pyname:0:1}/$_pyname/$_pyname-$pkgver.tar.gz"
builddir="$srcdir"/$_pyname-$pkgver
subpackages="$pkgname-pyc"

prepare() {
	default_prepare
	sed -i 's/==.*$//' test-requirements.txt requirements.txt
}

build() {
	export SETUPTOOLS_SCM_PRETEND_VERSION=$pkgver
	python3 -m build --wheel --no-isolation
}

check() {
	py.test --cov=docker tests/unit
}

package() {
	python3 -m installer --destdir="$pkgdir" dist/*.whl
	install -Dm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}
sha512sums="
52641af0c58ca496712d00a1363ecb43bda9cef01553a052f6f5295b04029ece3b9b7a860ee44a5fa7a4255e850d802c31309aecc93011d19d42dd45c2e03c0d  py3-docker-6.1.3.tar.gz
"
