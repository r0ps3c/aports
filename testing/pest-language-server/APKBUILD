# Contributor: lauren n. liberda <lauren@selfisekai.rocks>
# Maintainer: lauren n. liberda <lauren@selfisekai.rocks>
pkgname=pest-language-server
pkgver=0.3.3
pkgrel=0
pkgdesc="Language Server for Pest"
url="https://github.com/pest-parser/pest-ide-tools"
arch="all"
license="Apache-2.0"
makedepends="cargo cargo-auditable openssl-dev"
source="https://github.com/pest-parser/pest-ide-tools/archive/refs/tags/v$pkgver/pest-ls-$pkgver.tar.gz"
builddir="$srcdir/pest-ide-tools-$pkgver"

prepare() {
	default_prepare

	cargo fetch --locked --target="$CBUILD"
}

build() {
	cargo auditable build -p pest-language-server --frozen --release
}

check() {
	cargo test -p pest-language-server --frozen
}

package() {
	install -Dm755 target/release/pest-language-server "$pkgdir"/usr/bin/pest-language-server
}

sha512sums="
715bffc08c40db8e237d535846e3c3a6a870d8bc6602ad50cc6804335e3166fc2e070cf72ff53878390a94206bc3dc4a068c758948c473657c62be6eb9ba6024  pest-ls-0.3.3.tar.gz
"
