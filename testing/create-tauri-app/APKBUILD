# Contributor: Matthias Ahouansou <matthias@ahouansou.cz>
# Maintainer: Matthias Ahouansou <matthias@ahouansou.cz>
pkgname=create-tauri-app
pkgver=4.2.0
pkgrel=0
pkgdesc="Build tool for Leptos"
url="https://tauri.app"
# loongarch64: blocked by libc crate
arch="all !s390x !loongarch64" # nix
license="MIT OR Apache-2.0"
makedepends="cargo-auditable"
depends="cargo"
subpackages="$pkgname-doc"
source="
	$pkgname-$pkgver.tar.gz::https://github.com/tauri-apps/create-tauri-app/archive/refs/tags/create-tauri-app-v$pkgver.tar.gz
"
options="net"
builddir="$srcdir/$pkgname-$pkgname-v$pkgver"

prepare() {
	default_prepare
	cargo fetch --target="$CTARGET" --locked
}

build() {
	cargo auditable build --release --frozen
}

check() {
	cargo test --frozen
}

package() {
	install -Dm 755 target/release/cargo-create-tauri-app "$pkgdir"/usr/bin/cargo-create-tauri-app

	for l in _APACHE-2.0 _MIT .spdx
	do
		install -Dm 644 LICENSE"$l" "$pkgdir"/usr/share/licenses/"$pkgname"/LICENSE"$l"
	done
}

sha512sums="
155e6791b96ce25fc878d5899237d3b6eecb1a035faa19cdac3a533cc4aed32b7adaaa5f7ced5b091a31ea7fa5f9fb26c9aae4cb03cb91a6cbdf403c46ec6c7c  create-tauri-app-4.2.0.tar.gz
"
