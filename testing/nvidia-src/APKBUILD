# Contributor: Dominika Liberda <ja@sdomi.pl>
# Maintainer: Dominika Liberda <ja@sdomi.pl>
pkgname=nvidia-src
pkgver=525.85.12
pkgrel=0
pkgdesc="NVIDIA Linux open GPU kernel module source (sources, AKMS)"
url="https://github.com/NVIDIA/open-gpu-kernel-modules"
# x86_64/aarch64 only
arch="noarch !riscv64 !s390x !armhf !armv7 !x86 !ppc64le"
license="MIT AND GPL-2.0-or-later"
depends="akms"
source="nvidia-$pkgver.tar.gz::https://github.com/NVIDIA/open-gpu-kernel-modules/archive/refs/tags/$pkgver.tar.gz
	AKMBUILD"
builddir="$srcdir/open-gpu-kernel-modules-$pkgver"
options="!check" # no tests

package() {
	mkdir -p "$pkgdir"/usr/src
	cp -r "$builddir" "$pkgdir"/usr/src/nvidia-$pkgver
	install -Dm644 "$srcdir"/AKMBUILD "$pkgdir"/usr/src/nvidia-$pkgver/AKMBUILD
}

sha512sums="
4bdb631d65d09ae8fe6324d301db2bed0635069e2abaa0cef07aea5a3a3c3ede3c7259ff6a9a5ef1142271f86b3961e86804eaa77d016437d42cf5a53dc59e77  nvidia-525.85.12.tar.gz
bdab6eb2556cba1b2bc0df7fc1d25dbcb5955a7288f71d17e61cf78777f3c64b097b362e04d6d3b7e30c68692af3078cb757387a54a387aabc7e61e0cad86dc8  AKMBUILD
"
