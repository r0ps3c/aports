Patch-Source: https://github.com/longxinH/xhprof/pull/86
From 49a69f92e7e2e17068cb16148298dba720896487 Mon Sep 17 00:00:00 2001
From: Andy Postnikov <apostnikov@gmail.com>
Date: Thu, 4 Jul 2024 20:56:38 +0200
Subject: [PATCH] Fix build for 8.4 and pcre2

---
 extension/xhprof.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/extension/xhprof.c b/extension/xhprof.c
index 15e5ac37..3d85a0b2 100755
--- a/xhprof.c
+++ b/xhprof.c
@@ -1290,7 +1290,11 @@ int hp_pcre_match(zend_string *pattern, const char *str, size_t len, zend_ulong
 #else
         zend_string *tmp = zend_string_init(str, len, 0);
         php_pcre_match_impl(pce_regexp, tmp, &matches, &subparts /* subpats */,
-                            0/* global */, 0/* ZEND_NUM_ARGS() >= 4 */, 0/*flags PREG_OFFSET_CAPTURE*/, 0/* start_offset */);
+                            0/* global */,
+#if PHP_VERSION_ID < 80400
+                            0/* ZEND_NUM_ARGS() >= 4 */,
+#endif
+                            0/*flags PREG_OFFSET_CAPTURE*/, 0/* start_offset */);
         zend_string_release(tmp);
 #endif
 
