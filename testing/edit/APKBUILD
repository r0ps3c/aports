# Contributor: Guy Godfroy <guy.godfroy@gugod.fr>
# Maintainer: Guy Godfroy <guy.godfroy@gugod.fr>
pkgname=edit
pkgver=1.0.0
pkgrel=0
pkgdesc="Simple editor for simple needs"
url="https://github.com/microsoft/edit"
arch="all"
license="MIT"
makedepends="cargo cargo-auditable"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/microsoft/edit/archive/refs/tags/v$pkgver.tar.gz
	01-unlock-all-archs.patch
	"
options="net"

prepare() {
	default_prepare

	cargo fetch --target="$CHOST" --locked
}

build() {
	export RUSTC_BOOTSTRAP=1
	cargo auditable build --frozen --release
}

check() {
	cargo test --frozen
}

package() {
	install -Dm755 target/release/edit "$pkgdir"/usr/bin/edit
	install -Dm644 LICENSE -t "$pkgdir"/usr/share/licenses/$pkgname/
}

sha512sums="
7291f0e6889b8305915ede661051747bb730dd0a9a9e5de313be63846bc0725ac12e07bd30b142825cb3e84ccd227d4a2c11a47fab895af03ef797a1f0c0429b  edit-1.0.0.tar.gz
10b827945814e0e3f46c87434bcd310ab8c6098ca564f10191061e727aacbebd6e915905b4372cd22d97dbceffaa77a537393a3d7253a446aaa70ccec139ec0c  01-unlock-all-archs.patch
"
